define("wixCodeInit",["lodash","coreUtils","platformInit","host-platform-api"],function(e,t,n,r){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1998)}({0:function(t,n){t.exports=e},1998:function(e,t,n){var r,o;r=[n(1999),n(2002),n(51)],void 0===(o=function(e,t,n){"use strict";return{getAppApi:e.getApi,initMainR:t,appsUtils:n.appsUtils,specMapUtils:n.specMapUtils,registerDeps:n.registerDeps}}.apply(t,r))||(e.exports=o)},1999:function(e,t,n){var r,o;r=[n(0),n(51),n(4),n(2e3),n(2001),n(90)],void 0===(o=function(e,t,n,r,o,i){"use strict";function a(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2],o=!!t.publicModel,i="undefined"!=typeof window&&!window.clientSideRender,a="undefined"==typeof window||window.isPseudoWindow,d=t.wixBiSession,c=d.visitorId,u={viewerSessionId:d.viewerSessionId,visitorId:c,initialTimestamp:d.initialTimestamp,ownerId:t.rendererModel.userId,deviceType:n.isMobileView?"mobile":"desktop",renderCycle:i&&!a?2:1,renderingEnv:a?"backend":"browser",userWarmup:t.userWarmup,locale:t.rendererModel.languageCode,sdkSource:n.sdkSource,namespacesSdkSource:n.namespacesSdkSource,externalComponentsSource:n.externalComponentsSource,wixCodeNamespacesAndElementorySupportSource:n.wixCodeNamespacesAndElementorySupportSource,openExperiments:function(t){return e.reduce(t,function(e,t,n){return"new"===t&&e.push(n),e},[])}(t.rendererModel.runningExperiments),applications:JSON.stringify(n.applications),metaSiteId:t.rendererModel.metaSiteId};return u=s(t)?e.merge(u,{compId:"wixCode_"+r.appDefinitionId,viewMode:o?"site":"preview"}):e.merge(u,{viewMode:o?"site":t.renderFlags.componentViewMode||"preview"})}function s(t){var n=t.rendererModel.clientSpecMap.toJS?t.rendererModel.clientSpecMap.toJS():t.rendererModel.clientSpecMap;return!!t.rendererModel.wixCodeModel&&e.some(n,{type:"siteextension"})}return{getApi:function(){var e=[],d=[],c=t.messageProxy.get(),u=!1,p=!0,l=null,f=null,g=null,m=void 0,v=void 0;return{init:function(d,p,l){if(u)console.warn("Wix code is already initiated");else{var f=t.appsUtils.getAppsBaseInfo({clientSpecMap:p,serviceTopology:d.serviceTopology,rendererModel:d.rendererModel}).length>0,g=void 0;if(s(d)){var M=t.specMapUtils.getAppSpec(p);g=r.buildUrl(d,M,l),m=o.getIFrameForApp(g,M),v=a(d,l,M)}else{if(!f)return;g=r.buildStaticUrl(d,l),m=o.getIFrameForApp(g,{}),v=a(d,l)}var S=function(n,r){o.isIFrameEvent(n,r)&&(function(e){return("PLATFORM_IFRAME"===e.intent||"WIX_CODE"===e.intent)&&"wix_code_iframe_initialized"===e.type}(r.data)&&n.contentWindow.postMessage(i.messageBuilder.setBootstrapParametersMessage(v),"*"),function(e){return("PLATFORM_IFRAME"===e.intent||"WIX_CODE"===e.intent)&&"wix_code_iframe_loaded"===e.type}(r.data)&&c.setMessageHandler(function(e){n.contentWindow.postMessage(e,"*")}),t.biUtils.shouldUseFallbackReportBI(r.data,e)&&t.biUtils.reportBiWithWixBiSession(r.data),e.forEach(function(e){e(r.data)}))}.bind(null,m);window.addEventListener("message",S,!1),function(e){function t(){var t=window.document.body;t.insertBefore(e,t.firstChild),n.loggingUtils.performance.mark("platform-iframe-added-to-dom")}"loading"!==window.document.readyState?t():window.document.addEventListener("DOMContentLoaded",function(){t()})}(m),u=!0}},destroyAppsContainer:function(){m&&(m.parentNode.removeChild(m),u=!1,c=t.messageProxy.get(),m=void 0)},sendMessage:function(e){e&&c.sendOrHoldMessage(function(e){return d.reduce(function(e,t){return t(e)},e)}(e))},registerMessageHandler:function(t){e.push(t)},registerMessageModifier:function(e){d.push(e)},unregisterMessageHandler:function(t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)},preLoadWidgets:function(e,n){!l&&s(e)&&t.widgetsPreLoader.asyncGetPreLoadMessage(e,n,function(e){p&&!l&&(l=e,c.sendOrHoldMessage(l))})},preLoadUserCode:function(e,n){(!f&&s(e)||t.appsUtils.getAppsBaseInfo({clientSpecMap:e.rendererModel.clientSpecMap,serviceTopology:e.serviceTopology,rendererModel:e.rendererModel}))&&t.widgetsPreLoader.asyncGetPreLoadUserCodeMessage(e,n,function(e){f||(f=e,c.sendOrHoldMessage(f))})},preInitWidgets:function(e,n){!g&&s(e)&&t.widgetsPreLoader.asyncGetPreInitMessage(e,n,function(e){g||(g=e,c.sendOrHoldMessage(g))})},isAppInitiated:function(){return u},getAppsIframe:function(){return m}}}}}.apply(t,r))||(e.exports=o)},2000:function(e,t,n){var r;void 0===(r=function(){"use strict";return{buildUrl:function(e,t){return function(e,t,n,r){var o=r?"pub":"dev",i="//"+t.instanceId+"."+o+".",a=e.serviceTopology.wixCloudBaseDomain,s="node_modules/santa-wix-code/"+(n.useWixCodeFallback?"fallback.html":"index.html");return i+function(){for(var e=arguments[0],t=1;t<arguments.length;++t)e=e.replace(/\/$/,"")+"/"+arguments[t].replace(/^\//,"");return e}(a,"_partials",function(e,t){var n=e.serviceTopology,r=function(e){return/^https?:\/\/localhost(:[0-9]+)?\/?$/.test(e)}(e.santaBase)||function(e){return/^https?:\/\/s3.amazonaws.com\/integration-tests-statics\/(.+)\/SNAPSHOT\/santa?$/.test(e)}(e.santaBase)?n.scriptsLocationMap.santa:e.santaBase;return r=function(e,t){var n=e.lastIndexOf("/");return function(e){return/^\d+\.\d+\.\d+$/.test(e)}(t)?e.substring(0,n+1)+t:e}(r,t),/(.*\/services\/)?(.*)/.exec(r)[2]}(e,n.runtimeSource),s)}(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},!!e.publicModel)},buildStaticUrl:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.santaBase+"/node_modules/santa-wix-code/"+(t.useWixCodeFallback?"fallback.html":"index.html")}}}.apply(t,[]))||(e.exports=r)},2001:function(e,t,n){var r,o;r=[n(0)],void 0===(o=function(e){"use strict";return{getIFrameForApp:function(t,n){var r=window.document.createElement("iframe");return r.style.cssText="position: fixed; left: 0; right: 0; top: 0; bottom: 0; width: 1px; height: 1px; background: transparent; border: 0",r.tabIndex=-1,r.setAttribute("aria-hidden","true"),r.src=t,e.get(n,"applicationId")&&e.get(n,"appDefinitionId")&&(r.setAttribute("data-app-id",n.applicationId),r.setAttribute("data-app-definition-id",n.appDefinitionId)),r},isIFrameEvent:function(e,t){return t.source===e.contentWindow}}}.apply(t,r))||(e.exports=o)},2002:function(e,t,n){var r,o;r=[n(0),n(51)],void 0===(o=function(e,t){"use strict";return function(e){var n=e.appApi,r=e.siteModel,o=e.isMobileView,i=e.queryUtil,a=e.currentUrl,s=e.isBot;a=a||window.document.location.href;var d=t.wixCodeUrlUtils.buildScriptsSources(r.serviceTopology,{isDebug:i.getParameterByName("debug")}),c=d.sdkSource,u=d.namespacesSdkSource,p=d.externalComponentsSource,l=d.wixCodeNamespacesAndElementorySupportSource,f=function(e){return"false"!==e&&("true"===e||!window.Worker||s)}(i.getParameterByName("useWixCodeFallback")),g={isMobileView:o,sdkSource:c,namespacesSdkSource:u,externalComponentsSource:p,wixCodeNamespacesAndElementorySupportSource:l,runtimeSource:i.getParameterByName("WixCodeRuntimeSource"),ReactSource:i.getParameterByName("ReactSource"),useWixCodeFallback:f},m=i.getParameterByName("viewerPlatformAppSources");g.applications=t.appsUtils.getAppsBaseInfo({rendererModel:r.rendererModel,clientSpecMap:r.rendererModel.clientSpecMap,serviceTopology:r.serviceTopology,viewerPlatformAppSources:m,currentUrl:a,santaBase:r.santaBase}),function(e){n.init(r,e,g),function(e){return t.specMapUtils.getAppSpec(e)||g.applications.length}(e)&&(n.preLoadUserCode(r,a),r.publicModel&&n.preLoadWidgets(r,a))}(r.rendererModel.clientSpecMap)}}.apply(t,r))||(e.exports=o)},4:function(e,n){e.exports=t},51:function(e,t){e.exports=n},90:function(e,t){e.exports=r}})});
//# sourceMappingURL=wixCodeInit.min.js.map